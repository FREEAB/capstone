<!-- start gronemeier code -->
<!DOCTYPE html>
<html>

<head>
    <title>Dashboard</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-9ndCyUaIbzAi2FUVXJi0CjmCapSmO7SnpJef0486qhLnuZ2cdeRhO02iuK6FUUVM" crossorigin="anonymous">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-9ndCyUaIbzAi2FUVXJi0CjmCapSmO7SnpJef0486qhLnuZ2cdeRhO02iuK6FUUVM" crossorigin="anonymous">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"
        integrity="sha384-ka7Sk0Gln4gmtz2MlQnikT1wXgYsOg+OMhuP+IlRH9sENBO0LRn5q+8nbTov4+1p"
        crossorigin="anonymous"></script>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.1/dist/js/bootstrap.min.js"
        integrity="sha384-Atwg2Pkwv9vp0ygtn1JAojH0nYbwNJLPhwyoVbhoPwBhjQPR5VtM2+xf0Uwh9KtT"
        crossorigin="anonymous"></script>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.9.2/dist/umd/popper.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.1/dist/js/bootstrap.min.js"
        integrity="sha384-Atwg2Pkwv9vp0ygtn1JAojH0nYbwNJLPhwyoVbhoPwBhjQPR5VtM2+xf0Uwh9KtT"
        crossorigin="anonymous"></script>
</head>

<body class="bg-dark">
    <nav class="navbar navbar-expand-lg" style="background-color: rgb(45, 129, 219);">
        <div class="collapse navbar-collapse" id="navbarSupportedContent">
            <ul class="navbar-nav mr-auto">
                <li class="nav-item active">
                    <a class="nav-link link-dark h5" href="/dashboard">Dashboard</a>
                </li>
                <li class="nav-item">
                    <a class="nav-link link-dark h5" href="/settings">Settings</a>
                </li>
                <li class="nav-item">
                    <a class="nav-link link-dark h5" href="/create">Create</a>
                </li>
            </ul>

        </div>
    </nav>
    <div class="table-responsive m">
        <table class="table table-dark">
            <thead>
                <tr>
                    <th>Name</th>
                    <% for (var i=0; i < 14; i++) { %>
                        <th id="day_<%=i%>_header">Day <%=i%>
                        </th>
                        <% } %>
                </tr>


                <% for (let user of users ) { %>
                    <tr>
                        <td>
                            <%= user.lastName %>
                        </td>
                        <% for (var j=0; j < 14; j++) { %>
                            <td id="<%=user.id%>_day_<%=j%>" style="padding: 1px; width: 6.66%">
                                <!-- select dropdown menu -->
                                <select class="form-select dropcolors day_<%=j%>" aria-label="Select">
                                    <option selected></option>
                                    <option value="1">H2O</option>
                                    <option value="2">ShOC</option>
                                    <option value="3">Telework</option>
                                    <option value="4">Leave</option>
                                    <option value="5">Sick</option>
                                    <option value="6">Holiday</option>
                            </td>
                            <% } %>
                    </tr>
                    <% } %>
                        <!-- stores info from dropdown to locations table in pgAdmin database -->
                        <script>
                            const dropdownColors = document.querySelectorAll('.dropcolors')
                            dropdownColors.forEach((dropdown) => {
                                dropdown.addEventListener('change', (event) => {
                                    // get id of dropdown
                                    const id = event.target.id;
                                    // get value of dropdown
                                    const value = event.target.value;
                                    // get day of dropdown
                                    const day = id.split("_")[2];
                                    // get user id of dropdown
                                    const user_id = id.split("_")[0];
                                    // send data to server
                                    fetch('/dashboard', {
                                        method: 'POST',
                                        headers: {
                                            'Content-Type': 'application/json'
                                        },
                                        body: JSON.stringify({
                                            user_id: user_id,
                                            day: day,
                                            value: value
                                        })
                                    }).then((response) => {
                                        return response.json();
                                    }).then((data) => {
                                        console.log(data);
                                    });
                                });
                            });
                        </script>
            </thead>
        </table>
    </div>

    <script src="scripts/dashboard.js"> </script>
    <script>
        // function to change color of dropdown menu
        const dropdowns = document.querySelectorAll('.dropcolors')
        dropdowns.forEach((dropdown) => {
            dropdown.addEventListener('change', (event) => {
                // change background color depending on what item selected in dropdown
                if (event.target.value == 1) {
                    event.target.style.backgroundColor = "rgb(135, 206, 235)";
                } else if (event.target.value == 2) {
                    event.target.style.backgroundColor = "rgb(237, 221, 119)";
                } else if (event.target.value == 3) {
                    event.target.style.backgroundColor = "rgb(227, 143, 242)";
                } else if (event.target.value == 4) {
                    event.target.style.backgroundColor = "rgb(237,100,100)";
                } else if (event.target.value == 5) {
                    event.target.style.backgroundColor = "rgb(59,163,92)";
                } else if (event.target.value == 6) {
                    event.target.style.backgroundColor = "rgb(227,133,61)";
                } else {
                    event.target.style.backgroundColor = "white";
                }
            });
        });
    </script>

</body>

</html>
<!-- end gronemeier code -->